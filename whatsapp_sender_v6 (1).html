
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù…ÙØ±Ø³ÙÙ„ ÙˆØ§ØªØ³Ø§Ø¨ â€” 180 Ø±Ù‚Ù… (Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø³ØªÙƒÙ…Ø§Ù„)</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; background:#fafafa; color:#111; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:20px; max-width: 1000px; margin:auto; box-shadow:0 4px 12px rgba(0,0,0,.05); }
    h1 { margin-top:0; font-size: 22px; }
    label { font-weight:600; display:block; margin: 16px 0 8px; }
    textarea, input[type="number"], input[type="text"], select, input[type="file"], input[type="checkbox"] { width:100%; padding:12px; border:1px solid #d1d5db; border-radius:10px; font-size:14px; box-sizing:border-box; background:#fff; }
    textarea { min-height: 140px; resize: vertical; }
    .row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    .row > div { flex:1; min-width: 220px; }
    .btns { display:flex; gap:10px; margin-top:16px; flex-wrap: wrap; }
    button { border:0; padding:12px 18px; border-radius:12px; font-weight:700; cursor:pointer; }
    .start { background:#16a34a; color:#fff; }
    .pause { background:#f59e0b; color:#fff; }
    .resume { background:#3b82f6; color:#fff; }
    .stop { background:#ef4444; color:#fff; }
    .secondary { background:#e5e7eb; color:#111; }
    .muted { color:#6b7280; font-size:13px; }
    .log { background:#0b1020; color:#c7d2fe; font-family: ui-monospace, Menlo, Consolas, monospace; padding:12px; border-radius:10px; height:190px; overflow:auto; }
    .badge { display:inline-block; background:#eef2ff; border:1px solid #c7d2fe; color:#3730a3; padding:2px 8px; border-radius:999px; font-size:12px; }
    .stats { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .footer { margin-top: 10px; font-size: 12px; color:#555; }
    .tip { background:#f0fdf4; border:1px dashed #86efac; padding:10px; border-radius:12px; }
    .inline { display:inline-flex; align-items:center; gap:8px; }
    .checkbox { display:flex; gap:8px; align-items:center; margin-top:8px; }
    .warn { background:#fff7ed; border:1px solid #fdba74; color:#7c2d12; padding:10px; border-radius:12px; }
    .pill { display:inline-block; padding:4px 8px; border-radius:999px; background:#eef2ff; border:1px solid #c7d2fe; color:#3730a3; font-size:12px; margin-left:6px; }
    .small { font-size:12px; color:#555; }
    kbd { padding:2px 6px; border:1px solid #ccc; border-bottom-width:2px; border-radius:6px; background:#f9f9f9; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Ù…ÙØ±Ø³ÙÙ„ ÙˆØ§ØªØ³Ø§Ø¨ â€” Ø­ØªÙ‰ 180 Ø±Ù‚Ù… (ÙØªØ­ Ø±ÙˆØ§Ø¨Ø· Ù…ØªØªØ§Ù„ÙŠØ©)</h1>
    <p class="muted">
      ÙŠÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© Ù„ÙƒÙ„ Ø±Ù‚Ù… Ù…Ø¹ Ù†Øµ Ù…ÙØ¹Ø¨Ù‘Ø£. Ù„ØªØ¬Ø§ÙˆØ² Ø­Ø§Ù„Ø§Øª ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ù†ØµØŒ ÙŠØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§Ø› Ø¥Ø°Ø§ ÙÙØªØ­ Ø¨Ø¯ÙˆÙ† Ù†Øµ: Ø£Ù„ØµÙ‚ <kbd>Ctrl/âŒ˜+V</kbd> ÙˆØ§Ø¶ØºØ· Enter.
    </p>

    <div class="row">
      <div>
        <label>Ù†Ù…Ø· Ø§Ù„Ø±Ø§Ø¨Ø·:</label>
        <select id="mode">
          <option value="auto" selected>ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù…ÙˆØµÙ‰ Ø¨Ù‡)</option>
          <option value="web">web.whatsapp.com/send</option>
          <option value="api">api.whatsapp.com/send</option>
          <option value="wa">wa.me</option>
        </select>
      </div>
      <div class="checkbox">
        <input id="singleTab" type="checkbox" checked/>
        <label for="singleTab">Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ¨ÙˆÙŠØ¨ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·</label>
      </div>
      <div class="checkbox">
        <input id="forceClipboard" type="checkbox" checked/>
        <label for="forceClipboard">Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù‚Ø¨Ù„ ÙØªØ­ ÙƒÙ„ Ø±Ù‚Ù…</label>
      </div>
      <div class="checkbox">
        <input id="shuffle" type="checkbox"/>
        <label for="shuffle">ØªØ±ØªÙŠØ¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù„Ø£Ø±Ù‚Ø§Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      </div>
    </div>

    <label>Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (ÙŠØ¯Ø¹Ù… ÙØ§ØµÙ„Ø©/Ø³Ø·Ø±/Ù…Ø³Ø§ÙØ©):</label>
    <textarea id="numbers" placeholder="Ù„ØµÙ‚ 180 Ø±Ù‚Ù… Ù‡Ù†Ø§..."></textarea>
    <div class="row">
      <div>
        <label>Ø£Ùˆ Ø§Ø±ÙØ¹ CSV:</label>
        <input id="csvFile" type="file" accept=".csv,text/csv"/>
        <div class="small">Ù†Ø³ØªØ®Ø±Ø¬ ÙƒÙ„ Ù…Ø§ ÙŠØ´Ø¨Ù‡ Ø±Ù‚Ù…Ù‹Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</div>
      </div>
      <div>
        <label>Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ (Ø«ÙˆØ§Ù†ÙŠ):</label>
        <input id="delay" type="number" min="5" step="1" value="10"/>
      </div>
      <div>
        <label>Ø¨Ø¯Ø¡ Ù…Ù† Ø±Ù‚Ù…:</label>
        <input id="startIndex" type="number" min="1" step="1" value="1"/>
      </div>
    </div>

    <label>Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</label>
    <textarea id="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§"></textarea>

    <div class="warn" id="lengthWarn" style="display:none">
      Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø·ÙˆÙŠÙ„Ø© Ø¬Ø¯Ù‹Ø§ ÙˆÙ‚Ø¯ ÙŠØªØ¬Ø§Ù‡Ù„ ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ…Ø±ÙŠØ±Ù‡Ø§. Ø³ÙŠØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒØ­Ù„ Ø¨Ø¯ÙŠÙ„.
    </div>

    <div class="btns">
      <button class="start" id="startBtn">Ø¨Ø¯Ø¡</button>
      <button class="pause" id="pauseBtn" disabled>Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª</button>
      <button class="resume" id="resumeBtn" disabled>Ø§Ø³ØªØ¦Ù†Ø§Ù</button>
      <button class="stop" id="stopBtn" disabled>Ø¥ÙŠÙ‚Ø§Ù</button>
      <button class="secondary" id="previewBtn">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ Ø±Ù‚Ù…</button>
      <button class="secondary" id="clearBtn">Ù…Ø³Ø­</button>
    </div>

    <div class="stats">
      <span>Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©: <span class="badge" id="progress">0 / 0</span></span>
      <span>Ø§Ù„Ø­Ø§Ù„Ø©: <span class="badge" id="status">Ø¬Ø§Ù‡Ø²</span></span>
      <span class="pill" id="countBadge">0 Ø±Ù‚Ù…</span>
      <span class="pill" id="resumeInfo" style="display:none"></span>
    </div>

    <label>Ø§Ù„Ø³Ø¬Ù„:</label>
    <div class="log" id="log"></div>

    <div class="tip">
      <strong>ØªÙ„Ù…ÙŠØ­Ø§Øª:</strong>
      <ul>
        <li>Ø¹Ø·Ù‘Ù„ Ù…Ø§Ù†Ø¹ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©.</li>
        <li>Ø§Ø¯Ø®Ù„ Ø¹Ù„Ù‰ <strong>web.whatsapp.com</strong> Ù…Ø³Ø¨Ù‚Ù‹Ø§.</li>
        <li>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª Ø«Ù… Ø§Ù„Ø§Ø³ØªØ¦Ù†Ø§Ù Ù„Ø§Ø­Ù‚Ù‹Ø§ â€” ÙˆØ³ÙŠØªÙ… Ø­ÙØ¸ Ù…ÙˆØ¶Ø¹Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</li>
      </ul>
    </div>

    <div class="footer">
      ÙØªØ­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙÙ‚Ø· â€” Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙŠØ¯ÙˆÙŠÙ‹Ø§. Ù„Ø§ ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø±Ù‚Ø§Ù….
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const modeEl = $('mode');
    const singleTabEl = $('singleTab');
    const forceClipboardEl = $('forceClipboard');
    const shuffleEl = $('shuffle');
    const numbersEl = $('numbers');
    const csvFileEl = $('csvFile');
    const messageEl = $('message');
    const delayEl = $('delay');
    const startIndexEl = $('startIndex');
    const logEl = $('log');
    const progressEl = $('progress');
    const statusEl = $('status');
    const startBtn = $('startBtn');
    const pauseBtn = $('pauseBtn');
    const resumeBtn = $('resumeBtn');
    const stopBtn = $('stopBtn');
    const clearBtn = $('clearBtn');
    const previewBtn = $('previewBtn');
    const lengthWarn = $('lengthWarn');
    const countBadge = $('countBadge');
    const resumeInfo = $('resumeInfo');

    let stopFlag = false;
    let pauseFlag = false;
    let idx = 0;
    let list = [];
    let tabRef = null;
    let timer = null;
    const LS_KEY = 'wa_sender_state_v6';

    function isMobile() {
      return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(navigator.userAgent);
    }

    function chosenMode() {
      const sel = modeEl.value;
      if (sel !== 'auto') return sel;
      return isMobile() ? 'api' : 'web';
    }

    function log(msg) {
      const time = new Date().toLocaleTimeString();
      logEl.textContent += `[${time}] ${msg}\n`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function countUpdate(n) {
      countBadge.textContent = n + ' Ø±Ù‚Ù…';
    }

    function extractNumbers(text) {
      const tokens = text.split(/[\s,;]+/).map(s => s.trim()).filter(Boolean);
      const set = new Set();
      const cleaned = [];
      for (const t of tokens) {
        const onlyDigits = t.replace(/\D/g, '');
        if (onlyDigits && onlyDigits.length >= 8 && !set.has(onlyDigits)) {
          set.add(onlyDigits);
          cleaned.push(onlyDigits);
        }
      }
      return cleaned;
    }

    function parseNumbers() {
      const raw = numbersEl.value || '';
      return extractNumbers(raw);
    }

    numbersEl.addEventListener('input', () => {
      const arr = parseNumbers();
      countUpdate(arr.length);
      saveState({numbers: numbersEl.value});
    });

    csvFileEl.addEventListener('change', () => {
      const file = csvFileEl.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        const text = reader.result || '';
        const arr = extractNumbers(text.toString());
        if (arr.length === 0) { alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ù.'); return; }
        const existing = parseNumbers();
        const merged = Array.from(new Set([...existing, ...arr]));
        numbersEl.value = merged.join('\n');
        countUpdate(merged.length);
        log('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ' + arr.length + ' Ø±Ù‚Ù…Ù‹Ø§ Ù…Ù† CSV.');
        saveState({numbers: numbersEl.value});
      };
      reader.readAsText(file);
    });

    function updateProgress(current, total) {
      progressEl.textContent = `${current} / ${total}`;
    }

    function normalizeText(msg) {
      return msg.replace(/\r\n/g, '\n').replace(/\u200f|\u200e/g, '');
    }

    function buildLink(num, msg, mode) {
      const enc = encodeURIComponent(normalizeText(msg));
      if (mode === 'web') {
        return `https://web.whatsapp.com/send?phone=${num}&text=${enc}`;
      } else if (mode === 'api') {
        return `https://api.whatsapp.com/send?phone=${num}&text=${enc}`;
      } else {
        return `https://wa.me/${num}?text=${enc}`;
      }
    }

    function disableInputs(disabled) {
      numbersEl.disabled = disabled;
      messageEl.disabled = disabled;
      delayEl.disabled = disabled;
      startIndexEl.disabled = disabled;
      modeEl.disabled = disabled;
      singleTabEl.disabled = disabled;
      forceClipboardEl.disabled = disabled;
      shuffleEl.disabled = disabled;
      startBtn.disabled = disabled;
      pauseBtn.disabled = !disabled;
      stopBtn.disabled = !disabled;
      resumeBtn.disabled = true;
      previewBtn.disabled = disabled;
      clearBtn.disabled = disabled;
      csvFileEl.disabled = disabled;
    }

    async function copyToClipboard(text) {
      try {
        await navigator.clipboard.writeText(text);
        log('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø­Ø§ÙØ¸Ø©.');
      } catch (e) {
        log('ØªØ¹Ø°Ø± Ø§Ù„Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„Ù†Ø³Ø®Ù‡Ø§ ÙŠØ¯ÙˆÙŠÙ‹Ø§.');
      }
    }

    async function openLink(url) {
      if (singleTabEl.checked) {
        if (!tabRef || tabRef.closed) {
          tabRef = window.open(url, '_blank');
        } else {
          tabRef.location.href = url;
        }
      } else {
        window.open(url, '_blank');
      }
    }

    function checkLength(msg) {
      const over = msg.length > 1500;
      lengthWarn.style.display = over ? 'block' : 'none';
      return over;
    }

    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function saveState(partial = {}) {
      const prev = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
      const state = {
        numbers: numbersEl.value,
        message: messageEl.value,
        mode: modeEl.value,
        singleTab: singleTabEl.checked,
        forceClipboard: forceClipboardEl.checked,
        shuffle: shuffleEl.checked,
        delay: delayEl.value,
        startIndex: startIndexEl.value,
        idx,
        list,
        ...prev,
        ...partial
      };
      localStorage.setItem(LS_KEY, JSON.stringify(state));
      updateResumeInfo();
    }

    function loadState() {
      try {
        const state = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
        if (!state) return;
        if (state.numbers) numbersEl.value = state.numbers;
        if (state.message) messageEl.value = state.message;
        if (state.mode) modeEl.value = state.mode;
        if (typeof state.singleTab === 'boolean') singleTabEl.checked = state.singleTab;
        if (typeof state.forceClipboard === 'boolean') forceClipboardEl.checked = state.forceClipboard;
        if (typeof state.shuffle === 'boolean') shuffleEl.checked = state.shuffle;
        if (state.delay) delayEl.value = state.delay;
        if (state.startIndex) startIndexEl.value = state.startIndex;
        if (Array.isArray(state.list)) list = state.list;
        if (typeof state.idx === 'number') idx = state.idx;
        countUpdate(parseNumbers().length);
        updateResumeInfo();
      } catch {}
    }

    function updateResumeInfo() {
      const state = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
      if (Array.isArray(state.list) && state.list.length > 0 && typeof state.idx === 'number') {
        resumeInfo.style.display = 'inline-block';
        resumeInfo.textContent = 'Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ù…Ù†: ' + (state.idx + 1) + ' / ' + state.list.length;
        resumeBtn.disabled = false;
      } else {
        resumeInfo.style.display = 'none';
        resumeBtn.disabled = true;
      }
    }

    previewBtn.addEventListener('click', async () => {
      const arr = parseNumbers();
      if (arr.length === 0) { alert('Ø£Ø¶Ù Ø±Ù‚Ù…Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.'); return; }
      const num = arr[0];
      const msg = messageEl.value || '';
      if (!msg) { alert('Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹.'); return; }
      const mode = chosenMode();
      checkLength(msg);
      if (forceClipboardEl.checked) await copyToClipboard(msg);
      const url = buildLink(num, msg, mode);
      openLink(url);
      log(`Ù…Ø¹Ø§ÙŠÙ†Ø© (${mode}) Ù„Ù„Ø±Ù‚Ù…: ${num}`);
    });

    clearBtn.addEventListener('click', () => {
      numbersEl.value = '';
      messageEl.value = '';
      countUpdate(0);
      log('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰.');
      updateProgress(0, 0);
      statusEl.textContent = 'Ø¬Ø§Ù‡Ø²';
      localStorage.removeItem(LS_KEY);
      updateResumeInfo();
    });

    pauseBtn.addEventListener('click', () => {
      pauseFlag = true;
      statusEl.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª...';
      log('ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª Ø¹Ù†Ø¯: ' + (idx + 1));
      resumeBtn.disabled = false;
      pauseBtn.disabled = true;
      if (timer) clearTimeout(timer);
      saveState({ idx, list });
    });

    resumeBtn.addEventListener('click', () => {
      const state = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
      if (Array.isArray(state.list) && typeof state.idx === 'number') {
        list = state.list;
        idx = state.idx;
        pauseFlag = false;
        statusEl.textContent = 'Ø§Ø³ØªØ¦Ù†Ø§Ù...';
        resumeBtn.disabled = true;
        pauseBtn.disabled = false;
        disableInputs(true);
        continueLoop();
      }
    });

    stopBtn.addEventListener('click', () => {
      stopFlag = true;
      statusEl.textContent = 'Ø³ÙŠØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ...';
      log('Ø·Ù„Ø¨ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.');
      if (timer) clearTimeout(timer);
      saveState({ idx, list });
    });

    function continueLoop() {
      if (stopFlag || pauseFlag || idx >= list.length) {
        finalize();
        return;
      }
      const mode = chosenMode();
      const msg = messageEl.value || '';
      const num = list[idx];
      (async () => {
        if (forceClipboardEl.checked) await copyToClipboard(msg);
        const url = buildLink(num, msg, mode);
        await openLink(url);
        updateProgress(idx + 1, list.length);
        log(`ÙØªØ­ (${mode}) Ù„Ù„Ø±Ù‚Ù…: ${num}`);
        saveState({ idx, list });
        idx++;
        timer = setTimeout(continueLoop, Math.max(5, parseInt(delayEl.value, 10) || 10) * 1000);
      })();
    }

    startBtn.addEventListener('click', () => {
      list = parseNumbers();
      if (list.length === 0) { alert('Ø£Ø¶Ù Ø±Ù‚Ù…Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.'); return; }
      if (shuffleEl.checked) list = shuffleArray(list);
      const msg = messageEl.value || '';
      if (!msg) { alert('Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹.'); return; }
      const delay = Math.max(5, parseInt(delayEl.value, 10) || 10);
      let startAt = parseInt(startIndexEl.value, 10);
      if (isNaN(startAt) || startAt < 1) startAt = 1;

      checkLength(msg);

      idx = startAt - 1;
      stopFlag = false;
      pauseFlag = false;
      disableInputs(true);
      statusEl.textContent = 'Ø¬Ø§Ø±Ù ÙØªØ­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·...';
      updateProgress(idx, list.length);
      log('Ø¨Ø¯Ø£Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©. Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙƒÙ„ÙŠØ©: ' + list.length + 'ØŒ Ø§Ù„ØªØ£Ø®ÙŠØ±: ' + delay + ' Ø«Ø§Ù†ÙŠØ©.');
      saveState({ idx, list });

      continueLoop();
    });

    function finalize() {
      if (stopFlag) {
        log('ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø¹Ù†Ø¯ Ø§Ù„ÙÙ‡Ø±Ø³: ' + (idx + 1));
        statusEl.textContent = 'Ù…ÙØªÙˆÙ‚Ù‘Ù';
      } else if (pauseFlag) {
        log('Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªÙ‹Ø§ Ø¹Ù†Ø¯: ' + (idx + 1));
        statusEl.textContent = 'Ù…ÙØªÙˆÙ‚Ù‘Ù Ù…Ø¤Ù‚ØªÙ‹Ø§';
      } else {
        log('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù….');
        statusEl.textContent = 'Ø§Ù†ØªÙ‡Ù‰';
        localStorage.removeItem(LS_KEY);
      }
      disableInputs(false);
      resumeBtn.disabled = !pauseFlag;
      pauseBtn.disabled = true;
      stopBtn.disabled = true;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    loadState();

    // Ø±Ø³Ø§Ù„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© + Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©
    if (!messageEl.value) {
      messageEl.value = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡ØŒ
Ù…Ø±Ø­Ø¨Ø§ Ø·Ù„Ø§Ø¨ ÙˆØ·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØµÙŠÙÙŠØŒ Ù†Ø±Ø¬Ùˆ Ù…Ù†ÙƒÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„ØªØ§Ù„ÙŠ:
https://docs.google.com/forms/d/e/1FAIpQLSfBlHmfbGbyAZbUFE33i2PcYYRNU1D38Jr3E6w4YvBtDMs_EA/viewform?usp=dialog
Ø¹Ù„Ù…Ø§ Ø£Ù† Ø¢Ø®Ø± ÙˆÙ‚Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù‡Ùˆ Ø§Ù„Ø®Ù…ÙŠØ³ Ø§Ù„Ø³Ø§Ø¹Ø© Ù¨ ØµØ¨Ø§Ø­Ø§.

Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ø±Ø¬Ùˆ ØªØ³Ø¬ÙŠÙ„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† Ø§Ø¬Ù„ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø·.

Ø¯Ù…ØªÙ… Ø¨Ø®ÙŠØ± ğŸŒ·`;
    }
  </script>
</body>
</html>
